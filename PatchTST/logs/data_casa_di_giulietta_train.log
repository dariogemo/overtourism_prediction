Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=1, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='data_casa_di_giulietta_train.csv', dec_in=5, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=5, factor=1, fc_dropout=0.05, features='MS', freq='t', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='data_casa_di_giulietta_train', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=3, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='/home/dario/dev/Stage/Code/../main_dataset/count_data_train', seq_len=96, stride=8, subtract_last=0, target='count', test_flop=False, train_epochs=10, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : data_casa_di_giulietta_train_PatchTST_custom_ftMS_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 122478
val 17430
test 34953
	iters: 100, epoch: 1 | loss: 1.1698712
	speed: 0.4435s/iter; left time: 4195.4887s
	iters: 200, epoch: 1 | loss: 1.1584361
	speed: 0.3052s/iter; left time: 2857.2797s
	iters: 300, epoch: 1 | loss: 0.8092818
	speed: 0.3431s/iter; left time: 3177.5183s
	iters: 400, epoch: 1 | loss: 0.6204832
	speed: 0.4761s/iter; left time: 4361.3344s
	iters: 500, epoch: 1 | loss: 0.6598387
	speed: 0.4761s/iter; left time: 4314.1680s
	iters: 600, epoch: 1 | loss: 0.7455589
	speed: 0.4793s/iter; left time: 4294.6153s
	iters: 700, epoch: 1 | loss: 0.6832938
	speed: 0.4775s/iter; left time: 4231.5566s
	iters: 800, epoch: 1 | loss: 0.6660878
	speed: 0.4735s/iter; left time: 4148.4322s
	iters: 900, epoch: 1 | loss: 0.5578273
	speed: 0.4730s/iter; left time: 4096.2344s
Epoch: 1 cost time: 421.4488263130188
Epoch: 1, Steps: 956 | Train Loss: 0.7846069 Vali Loss: 0.7940468 Test Loss: 0.7463222
Validation loss decreased (inf --> 0.794047).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5625331
	speed: 1.4665s/iter; left time: 12472.8800s
	iters: 200, epoch: 2 | loss: 0.6389329
	speed: 0.4755s/iter; left time: 3996.9810s
	iters: 300, epoch: 2 | loss: 0.5092711
	speed: 0.4747s/iter; left time: 3942.0076s
	iters: 400, epoch: 2 | loss: 0.5834165
	speed: 0.4754s/iter; left time: 3900.2927s
	iters: 500, epoch: 2 | loss: 0.6879121
	speed: 0.4758s/iter; left time: 3856.4303s
	iters: 600, epoch: 2 | loss: 0.6507772
	speed: 0.4763s/iter; left time: 3812.9429s
	iters: 700, epoch: 2 | loss: 0.6235766
	speed: 0.4778s/iter; left time: 3777.0344s
	iters: 800, epoch: 2 | loss: 0.6317909
	speed: 0.4786s/iter; left time: 3735.1908s
	iters: 900, epoch: 2 | loss: 0.5831119
	speed: 0.4792s/iter; left time: 3691.8574s
Epoch: 2 cost time: 456.9677789211273
Epoch: 2, Steps: 956 | Train Loss: 0.5953936 Vali Loss: 0.7541835 Test Loss: 0.6935593
Validation loss decreased (0.794047 --> 0.754183).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4710250
	speed: 1.4820s/iter; left time: 11187.4308s
	iters: 200, epoch: 3 | loss: 0.5785826
	speed: 0.4809s/iter; left time: 3582.3051s
	iters: 300, epoch: 3 | loss: 0.5649844
	speed: 0.4813s/iter; left time: 3536.9250s
	iters: 400, epoch: 3 | loss: 0.5436980
	speed: 0.4818s/iter; left time: 3492.3377s
	iters: 500, epoch: 3 | loss: 0.5308032
	speed: 0.4823s/iter; left time: 3448.0142s
	iters: 600, epoch: 3 | loss: 0.5604495
	speed: 0.4826s/iter; left time: 3402.1587s
	iters: 700, epoch: 3 | loss: 0.6019314
	speed: 0.4828s/iter; left time: 3354.6490s
	iters: 800, epoch: 3 | loss: 0.5409396
	speed: 0.4828s/iter; left time: 3306.9039s
	iters: 900, epoch: 3 | loss: 0.5910262
	speed: 0.4831s/iter; left time: 3260.5941s
Epoch: 3 cost time: 461.93094873428345
Epoch: 3, Steps: 956 | Train Loss: 0.5579575 Vali Loss: 0.7630383 Test Loss: 0.7016355
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5158271
	speed: 1.4957s/iter; left time: 9861.2301s
	iters: 200, epoch: 4 | loss: 0.5774533
	speed: 0.4865s/iter; left time: 3158.8381s
	iters: 300, epoch: 4 | loss: 0.6880166
	speed: 0.4879s/iter; left time: 3119.3623s
	iters: 400, epoch: 4 | loss: 0.4450820
	speed: 0.4881s/iter; left time: 3071.8160s
	iters: 500, epoch: 4 | loss: 0.5059969
	speed: 0.4882s/iter; left time: 3023.6137s
	iters: 600, epoch: 4 | loss: 0.4979958
	speed: 0.4886s/iter; left time: 2976.8862s
	iters: 700, epoch: 4 | loss: 0.6030321
	speed: 0.4888s/iter; left time: 2929.5493s
	iters: 800, epoch: 4 | loss: 0.4978937
	speed: 0.4889s/iter; left time: 2881.2864s
	iters: 900, epoch: 4 | loss: 0.4836520
	speed: 0.4893s/iter; left time: 2834.3860s
Epoch: 4 cost time: 467.72488236427307
Epoch: 4, Steps: 956 | Train Loss: 0.5300074 Vali Loss: 0.7933355 Test Loss: 0.7300555
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5365391
	speed: 1.5116s/iter; left time: 8520.6476s
	iters: 200, epoch: 5 | loss: 0.5034394
	speed: 0.4911s/iter; left time: 2719.2663s
	iters: 300, epoch: 5 | loss: 0.4937100
	speed: 0.4909s/iter; left time: 2668.8304s
	iters: 400, epoch: 5 | loss: 0.5185695
	speed: 0.4912s/iter; left time: 2621.4629s
	iters: 500, epoch: 5 | loss: 0.5556356
	speed: 0.4914s/iter; left time: 2573.5947s
	iters: 600, epoch: 5 | loss: 0.5756885
	speed: 0.4914s/iter; left time: 2524.3416s
	iters: 700, epoch: 5 | loss: 0.5354443
	speed: 0.4920s/iter; left time: 2478.4276s
	iters: 800, epoch: 5 | loss: 0.5217022
	speed: 0.4912s/iter; left time: 2425.0542s
	iters: 900, epoch: 5 | loss: 0.4193711
	speed: 0.4913s/iter; left time: 2376.4282s
Epoch: 5 cost time: 470.71036887168884
Epoch: 5, Steps: 956 | Train Loss: 0.4956998 Vali Loss: 0.8137572 Test Loss: 0.7635220
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : data_casa_di_giulietta_train_PatchTST_custom_ftMS_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 34953
mse:0.6935592293739319, mae:0.43195641040802, rse:0.7432668805122375
