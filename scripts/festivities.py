from datetime import datetime

import numpy as np
import pandas as pd

fest_dic: "dict[int, list[list[int]]]" = {
    2014: [
        [1, 1],
        [1, 6],
        [4, 20],
        [4, 21],
        [4, 25],
        [5, 1],
        [6, 2],
        [8, 15],
        [11, 1],
        [12, 8],
        [12, 25],
        [12, 26],
        [12, 31],
    ],
    2015: [
        [1, 1],
        [1, 6],
        [4, 5],
        [4, 6],
        [4, 25],
        [5, 1],
        [6, 2],
        [8, 15],
        [11, 1],
        [12, 8],
        [12, 25],
        [12, 26],
        [12, 31],
    ],
    2016: [
        [1, 1],
        [1, 6],
        [3, 27],
        [3, 28],
        [4, 25],
        [5, 1],
        [6, 2],
        [8, 15],
        [11, 1],
        [12, 8],
        [12, 25],
        [12, 26],
        [12, 31],
    ],
    2017: [
        [1, 1],
        [1, 6],
        [4, 16],
        [4, 17],
        [4, 25],
        [5, 1],
        [6, 2],
        [8, 15],
        [11, 1],
        [12, 8],
        [12, 25],
        [12, 26],
        [12, 31],
    ],
    2018: [
        [1, 1],
        [1, 6],
        [4, 1],
        [4, 2],
        [4, 25],
        [5, 1],
        [6, 2],
        [8, 15],
        [11, 1],
        [12, 8],
        [12, 25],
        [12, 26],
        [12, 31],
    ],
    2019: [
        [1, 1],
        [1, 6],
        [4, 21],
        [4, 22],
        [4, 25],
        [5, 1],
        [6, 2],
        [8, 15],
        [11, 1],
        [12, 8],
        [12, 25],
        [12, 26],
        [12, 31],
    ],
    2020: [
        [1, 1],
        [1, 6],
        [4, 21],
        [4, 22],
        [4, 25],
        [5, 1],
        [6, 2],
        [8, 15],
        [11, 1],
        [12, 8],
        [12, 25],
        [12, 26],
        [12, 31],
    ],
}

fest_series: pd.Series = pd.Series([])
IDX: int = 0
for key, value in fest_dic.items():
    for i, date in enumerate(fest_dic[key]):
        fest_series[IDX] = datetime(key, date[0], date[1])
        IDX += 1

fest_df: pd.DataFrame = pd.DataFrame(
    np.ones(len(fest_series)), index=fest_series, columns=["values"]
)

fest_df: pd.DataFrame = fest_df.resample("15min").ffill(limit=95)
dates = pd.date_range(start="2019-12-31", end="2020-01-01", freq="15min")
fest_df: pd.DataFrame = pd.concat(
    [fest_df, pd.DataFrame(np.ones(len(dates)), index=dates, columns=["values"])],
    axis=0,
)[:-1]

fest_df.fillna(0, inplace=True)

arena_events = [
    "2014-06-20",
    "2014-06-23",
    "2014-06-28",
    "2014-07-03",
    "2014-07-11",
    "2014-07-19",
    "2014-07-24",
    "2014-07-31",
    "2014-09-03",
    "2014-09-07",
    "2015-06-19",
    "2015-06-25",
    "2015-06-29",
    "2015-07-04",
    "2015-07-09",
    "2015-07-15",
    "2015-07-18",
    "2015-07-20",
    "2015-07-22",
    "2015-07-23",
    "2015-07-24",
    "2015-08-13",
    "2015-08-18",
    "2015-08-22",
    "2015-08-25",
    "2015-08-26",
    "2015-08-29",
    "2015-08-31",
    "2015-09-01",
    "2015-09-05",
    "2016-06-24",
    "2016-06-25",
    "2016-06-26",
    "2016-06-28",
    "2016-06-29",
    "2016-06-30",
    "2016-07-03",
    "2016-07-07",
    "2016-07-14",
    "2016-07-17",
    "2016-07-24",
    "2016-07-28",
    "2016-07-31",
    "2016-08-07",
    "2016-08-09",
    "2016-08-14",
    "2016-08-18",
    "2016-08-21",
    "2016-08-24",
    "2016-08-28",
    "2016-07-10",
    "2017-06-23",
    "2017-06-24",
    "2017-06-26",
    "2017-07-01",
    "2017-07-08",
    "2017-07-10",
    "2017-07-21",
    "2017-07-25",
    "2017-08-26",
    "2017-08-27",
    "2017-10-15",
    "2017-10-16",
    "2017-04-18",
    "2018-06-22",
    "2018-06-23",
    "2018-06-29",
    "2018-06-30",
    "2018-07-02",
    "2018-07-03",
    "2018-07-06",
    "2018-07-07",
    "2018-07-10",
    "2018-07-11",
    "2018-07-12",
    "2018-07-13",
    "2018-07-17",
    "2018-07-18",
    "2018-07-19",
    "2018-07-20",
    "2018-07-21",
    "2018-07-25",
    "2018-07-28",
    "2018-08-03",
    "2018-08-09",
    "2018-08-12",
    "2018-08-22",
    "2018-08-25",
    "2018-08-28",
    "2018-08-31",
    "2018-09-01",
    "2018-01-29",
    "2018-02-06",
    "2018-02-07",
    "2018-10-08",
    "2018-11-12",
    "2018-11-19",
    "2018-12-25",
    "2019-06-21",
    "2019-06-22",
    "2019-06-27",
    "2019-06-28",
    "2019-07-03",
    "2019-07-05",
    "2019-07-09",
    "2019-07-11",
    "2019-07-12",
    "2019-07-19",
    "2019-07-21",
    "2019-07-24",
    "2019-07-25",
    "2019-07-28",
    "2019-08-01",
    "2019-08-03",
    "2019-08-04",
    "2019-08-08",
    "2019-08-09",
    "2019-08-17",
    "2019-08-18",
    "2019-08-22",
    "2019-08-25",
    "2019-08-28",
    "2019-08-30",
    "2019-08-31",
    "2019-09-03",
    "2019-09-05",
    "2019-09-07",
    "2020-07-24",
    "2020-07-25",
    "2020-07-31",
]

arena_events_dt = [datetime.strptime(d, "%Y-%m-%d") for d in arena_events]

for date in arena_events_dt:
    fest_df.loc[date, "values"] = 2

print(fest_df.value_counts())

fest_df.to_csv("./../../main_dataset/context_festivities.csv")

# TODO: check fest_dic iteration, might be wrong
