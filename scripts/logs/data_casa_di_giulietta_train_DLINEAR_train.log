Args in experiment:
Namespace(activation='gelu', batch_size=128, c_out=1, checkpoints='/home/dario/dev/Stage/Code/scripts/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='data_casa_di_giulietta_train.csv', dec_in=5, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=5, factor=1, features='MS', freq='t', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='DLinear', model_id='data_casa_di_giulietta_train', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='/home/dario/dev/Stage/Code/../main_dataset/count_data_train', seq_len=96, target='count', test_flop=False, testing=False, train_epochs=10, use_amp=False, use_gpu=True, use_multi_gpu=False)
this is accessed
Use GPU: cuda:0
>>>>>>>start training : data_casa_di_giulietta_train_DLinear_custom_ftMS_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
                  date  temp  rain  ...  rolling_mean_30d  above_avg  count
0  2014-01-01 13:30:00   5.3     0  ...               0.0          0      4
1  2014-01-01 13:45:00   5.3     0  ...               0.0          0     10
2  2014-01-01 14:00:00   5.3     0  ...               0.0          0     10
3  2014-01-01 14:15:00   5.3     0  ...               0.0          0     10
4  2014-01-01 14:30:00   5.3     0  ...               0.0          0      4

[5 rows x 7 columns]
train 122478
                  date  temp  rain  ...  rolling_mean_30d  above_avg  count
0  2014-01-01 13:30:00   5.3     0  ...               0.0          0      4
1  2014-01-01 13:45:00   5.3     0  ...               0.0          0     10
2  2014-01-01 14:00:00   5.3     0  ...               0.0          0     10
3  2014-01-01 14:15:00   5.3     0  ...               0.0          0     10
4  2014-01-01 14:30:00   5.3     0  ...               0.0          0      4

[5 rows x 7 columns]
val 17430
                  date  temp  rain  ...  rolling_mean_30d  above_avg  count
0  2014-01-01 13:30:00   5.3     0  ...               0.0          0      4
1  2014-01-01 13:45:00   5.3     0  ...               0.0          0     10
2  2014-01-01 14:00:00   5.3     0  ...               0.0          0     10
3  2014-01-01 14:15:00   5.3     0  ...               0.0          0     10
4  2014-01-01 14:30:00   5.3     0  ...               0.0          0      4

[5 rows x 7 columns]
test 34953
	iters: 100, epoch: 1 | loss: 0.7241828
	speed: 0.0101s/iter; left time: 95.5488s
	iters: 200, epoch: 1 | loss: 0.5955979
	speed: 0.0059s/iter; left time: 54.8407s
	iters: 300, epoch: 1 | loss: 0.6515220
	speed: 0.0062s/iter; left time: 57.2012s
	iters: 400, epoch: 1 | loss: 0.6100429
	speed: 0.0060s/iter; left time: 54.9858s
	iters: 500, epoch: 1 | loss: 0.6804465
	speed: 0.0060s/iter; left time: 54.8174s
	iters: 600, epoch: 1 | loss: 0.5373005
	speed: 0.0082s/iter; left time: 73.1181s
	iters: 700, epoch: 1 | loss: 0.6128729
	speed: 0.0080s/iter; left time: 70.9770s
	iters: 800, epoch: 1 | loss: 0.7013275
	speed: 0.0078s/iter; left time: 68.3850s
	iters: 900, epoch: 1 | loss: 0.7270125
	speed: 0.0082s/iter; left time: 71.0187s
Epoch: 1 cost time: 7.173959493637085
Epoch: 1, Steps: 956 | Train Loss: 0.6554983 Vali Loss: 0.7689979 Test Loss: 0.7208177
Validation loss decreased (inf --> 0.768998).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5949974
	speed: 0.0582s/iter; left time: 494.8855s
	iters: 200, epoch: 2 | loss: 0.5887575
	speed: 0.0077s/iter; left time: 64.3456s
	iters: 300, epoch: 2 | loss: 0.6023636
	speed: 0.0078s/iter; left time: 65.1212s
	iters: 400, epoch: 2 | loss: 0.5508333
	speed: 0.0078s/iter; left time: 64.0775s
	iters: 500, epoch: 2 | loss: 0.5925621
	speed: 0.0083s/iter; left time: 67.4113s
	iters: 600, epoch: 2 | loss: 0.5727763
	speed: 0.0079s/iter; left time: 63.1854s
	iters: 700, epoch: 2 | loss: 0.7433666
	speed: 0.0081s/iter; left time: 63.6475s
	iters: 800, epoch: 2 | loss: 0.7070667
	speed: 0.0080s/iter; left time: 62.3163s
	iters: 900, epoch: 2 | loss: 0.5529586
	speed: 0.0083s/iter; left time: 64.2327s
Epoch: 2 cost time: 8.206299304962158
Epoch: 2, Steps: 956 | Train Loss: 0.6144841 Vali Loss: 0.7663019 Test Loss: 0.7180826
Validation loss decreased (0.768998 --> 0.766302).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5813570
	speed: 0.0715s/iter; left time: 540.0041s
	iters: 200, epoch: 3 | loss: 0.7093832
	speed: 0.0152s/iter; left time: 113.3203s
	iters: 300, epoch: 3 | loss: 0.6918103
	speed: 0.0084s/iter; left time: 61.5831s
	iters: 400, epoch: 3 | loss: 0.6730072
	speed: 0.0094s/iter; left time: 68.2679s
	iters: 500, epoch: 3 | loss: 0.4999094
	speed: 0.0108s/iter; left time: 77.0367s
	iters: 600, epoch: 3 | loss: 0.5383497
	speed: 0.0086s/iter; left time: 60.5349s
	iters: 700, epoch: 3 | loss: 0.5340683
	speed: 0.0086s/iter; left time: 59.5229s
	iters: 800, epoch: 3 | loss: 0.6544164
	speed: 0.0089s/iter; left time: 60.6954s
	iters: 900, epoch: 3 | loss: 0.5916429
	speed: 0.0096s/iter; left time: 64.6597s
Epoch: 3 cost time: 9.894002437591553
Epoch: 3, Steps: 956 | Train Loss: 0.6130266 Vali Loss: 0.7654097 Test Loss: 0.7174086
Validation loss decreased (0.766302 --> 0.765410).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5373668
	speed: 0.0816s/iter; left time: 538.0479s
	iters: 200, epoch: 4 | loss: 0.4510751
	speed: 0.0102s/iter; left time: 66.2590s
	iters: 300, epoch: 4 | loss: 0.6598306
	speed: 0.0088s/iter; left time: 56.1265s
	iters: 400, epoch: 4 | loss: 0.5577990
	speed: 0.0089s/iter; left time: 55.7632s
	iters: 500, epoch: 4 | loss: 0.5886039
	speed: 0.0091s/iter; left time: 56.6560s
	iters: 600, epoch: 4 | loss: 0.5920035
	speed: 0.0094s/iter; left time: 57.4052s
	iters: 700, epoch: 4 | loss: 0.6990401
	speed: 0.0113s/iter; left time: 67.9007s
	iters: 800, epoch: 4 | loss: 0.6646607
	speed: 0.0140s/iter; left time: 82.2140s
	iters: 900, epoch: 4 | loss: 0.7053351
	speed: 0.0097s/iter; left time: 56.4616s
Epoch: 4 cost time: 10.863945245742798
Epoch: 4, Steps: 956 | Train Loss: 0.6126887 Vali Loss: 0.7655527 Test Loss: 0.7173542
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5622590
	speed: 0.0738s/iter; left time: 416.2404s
	iters: 200, epoch: 5 | loss: 0.5243527
	speed: 0.0092s/iter; left time: 51.1508s
	iters: 300, epoch: 5 | loss: 0.6191900
	speed: 0.0143s/iter; left time: 78.0117s
	iters: 400, epoch: 5 | loss: 0.6349176
	speed: 0.0100s/iter; left time: 53.4582s
	iters: 500, epoch: 5 | loss: 0.5766718
	speed: 0.0088s/iter; left time: 46.2046s
	iters: 600, epoch: 5 | loss: 0.4678698
	speed: 0.0149s/iter; left time: 76.3174s
	iters: 700, epoch: 5 | loss: 0.6992657
	speed: 0.0092s/iter; left time: 46.3255s
	iters: 800, epoch: 5 | loss: 0.7166135
	speed: 0.0100s/iter; left time: 49.3581s
	iters: 900, epoch: 5 | loss: 0.7604284
	speed: 0.0140s/iter; left time: 67.8383s
Epoch: 5 cost time: 11.085877656936646
Epoch: 5, Steps: 956 | Train Loss: 0.6125533 Vali Loss: 0.7650071 Test Loss: 0.7173133
Validation loss decreased (0.765410 --> 0.765007).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7679027
	speed: 0.0750s/iter; left time: 351.1917s
	iters: 200, epoch: 6 | loss: 0.6166868
	speed: 0.0091s/iter; left time: 41.5156s
	iters: 300, epoch: 6 | loss: 0.5955126
	speed: 0.0142s/iter; left time: 63.8293s
	iters: 400, epoch: 6 | loss: 0.5583438
	speed: 0.0102s/iter; left time: 44.8623s
	iters: 500, epoch: 6 | loss: 0.7383984
	speed: 0.0117s/iter; left time: 50.2777s
	iters: 600, epoch: 6 | loss: 0.5963936
	speed: 0.0100s/iter; left time: 41.8871s
	iters: 700, epoch: 6 | loss: 0.6024809
	speed: 0.0100s/iter; left time: 40.6948s
	iters: 800, epoch: 6 | loss: 0.6536348
	speed: 0.0100s/iter; left time: 39.8486s
	iters: 900, epoch: 6 | loss: 0.7485527
	speed: 0.0102s/iter; left time: 39.5434s
Epoch: 6 cost time: 10.779852151870728
Epoch: 6, Steps: 956 | Train Loss: 0.6123810 Vali Loss: 0.7653693 Test Loss: 0.7173526
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6247128
	speed: 0.0755s/iter; left time: 281.3754s
	iters: 200, epoch: 7 | loss: 0.6649278
	speed: 0.0105s/iter; left time: 38.2115s
	iters: 300, epoch: 7 | loss: 0.6087503
	speed: 0.0106s/iter; left time: 37.2770s
	iters: 400, epoch: 7 | loss: 0.6332250
	speed: 0.0109s/iter; left time: 37.4104s
	iters: 500, epoch: 7 | loss: 0.5694223
	speed: 0.0105s/iter; left time: 34.8650s
	iters: 600, epoch: 7 | loss: 0.5899116
	speed: 0.0106s/iter; left time: 34.1736s
	iters: 700, epoch: 7 | loss: 0.5789174
	speed: 0.0103s/iter; left time: 32.2357s
	iters: 800, epoch: 7 | loss: 0.6404581
	speed: 0.0104s/iter; left time: 31.3743s
	iters: 900, epoch: 7 | loss: 0.6223487
	speed: 0.0105s/iter; left time: 30.6479s
Epoch: 7 cost time: 10.861276149749756
Epoch: 7, Steps: 956 | Train Loss: 0.6123818 Vali Loss: 0.7653627 Test Loss: 0.7173749
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5734176
	speed: 0.0769s/iter; left time: 212.8965s
	iters: 200, epoch: 8 | loss: 0.5530626
	speed: 0.0103s/iter; left time: 27.3861s
	iters: 300, epoch: 8 | loss: 0.6290882
	speed: 0.0107s/iter; left time: 27.5108s
	iters: 400, epoch: 8 | loss: 0.6139400
	speed: 0.0104s/iter; left time: 25.6617s
	iters: 500, epoch: 8 | loss: 0.6000780
	speed: 0.0104s/iter; left time: 24.5405s
	iters: 600, epoch: 8 | loss: 0.6278125
	speed: 0.0102s/iter; left time: 23.0535s
	iters: 700, epoch: 8 | loss: 0.5626557
	speed: 0.0108s/iter; left time: 23.4800s
	iters: 800, epoch: 8 | loss: 0.9066986
	speed: 0.0104s/iter; left time: 21.5603s
	iters: 900, epoch: 8 | loss: 0.6133952
	speed: 0.0099s/iter; left time: 19.4256s
Epoch: 8 cost time: 10.49555778503418
Epoch: 8, Steps: 956 | Train Loss: 0.6123697 Vali Loss: 0.7651019 Test Loss: 0.7173728
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : data_casa_di_giulietta_train_DLinear_custom_ftMS_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
                  date  temp  rain  ...  rolling_mean_30d  above_avg  count
0  2014-01-01 13:30:00   5.3     0  ...               0.0          0      4
1  2014-01-01 13:45:00   5.3     0  ...               0.0          0     10
2  2014-01-01 14:00:00   5.3     0  ...               0.0          0     10
3  2014-01-01 14:15:00   5.3     0  ...               0.0          0     10
4  2014-01-01 14:30:00   5.3     0  ...               0.0          0      4

[5 rows x 7 columns]
test 34953
loading model
/home/dario/dev/Stage/Code/scripts/checkpoints/data_casa_di_giulietta_train_DLinear_custom_ftMS_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0/checkpoint.pth
mse:0.7173134684562683, mae:0.463084876537323, rse:0.7558881640434265
